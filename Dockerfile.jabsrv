# FROM eclipse-temurin:24-jdk AS build
FROM gradle:jdk24-noble AS build

WORKDIR /app

COPY . .

# RUN ./gradlew :jabsrv:shadowJar
RUN gradle --no-daemon :jabsrv:shadowJar

RUN mv jabsrv/build/libs/jabsrv*-all.jar jabsrv.jar

FROM eclipse-temurin:24-jre AS runtime

WORKDIR /app

COPY --from=build /app/jabsrv.jar .

EXPOSE 6050

# Run server
ENTRYPOINT ["java", "-jar", "jabsrv.jar"]
