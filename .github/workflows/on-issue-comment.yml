name: On isuse comment

on:
  issue_comment:
    types: [created]

jobs:
  assign:
    if: github.repository_owner == 'JabRef'
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
    steps:
      - name: Assign the user or unassign stale assignments
        id: assign
        # uses: takanome-dev/assign-issue-action@edge
        uses: takanome-dev/assign-issue-action@feat/github-teams-support
        with:
          github_token: '${{ secrets.GH_TOKEN_ASSIGN_ISSUE_ACTION  || github.token }}'
          # If this is updated, also update the number at unassign-issues.yml
          days_until_unassign: 21
          # One person should work on one issue only
          max_assignments: 1
          maintainers: '@JabRef/developers,Siedlerchr,ThiloteE,calixtus,HoussemNasri,subhramit,InAnYan'
          assigned_comment: >
            ğŸ‘‹ Hey @{{ handle }}, thank you for your interest in this issue! ğŸ‰


            We're excited to have you on board.
            Start by exploring our [Contributing guidelines](https://github.com/JabRef/jabref/blob/main/CONTRIBUTING.md), and set up your local development workspace by following the steps in our [workspace setup guidelines](https://devdocs.jabref.org/getting-into-the-code/guidelines-for-setting-up-a-local-workspace) to get started smoothly.


            For questions on JabRef functionality, you can consult the [JabRef Guru](https://gurubase.io/g/jabref).
            For questions related to the codebase, please start using [DeepWiki](https://deepwiki.com/JabRef/jabref).


            In case you encounter failing tests during development, please check our [developer FAQs](https://devdocs.jabref.org/code-howtos/faq.html)!


            Still facing issues or having more questions?
            Feel free to ask here on GitHub or on [JabRef's Gitter chat](https://gitter.im/JabRef/jabref).
            Please don't hesitate to open a (draft) pull request early on to show the direction you are heading towards if unsure.


            Happy coding! ğŸš€
          assignment_suggestion_comment: >
            ğŸ‘‹ Hey @{{ handle }}, looks like youâ€™re eager to work on this issue â€” great! ğŸ‰
            It also looks like you don't know how to assign issues to yourself.
            Please read our [CONTRIBUTING.md](https://github.com/JabRef/jabref/blob/main/CONTRIBUTING.md) to find out how.
            It will also guide you in other aspects of contributing to JabRef.
          unassigned_comment: |
            ### ğŸ“‹ Assignment Update

            Hi @{{ handle }}, due to inactivity, you have been unassigned from this issue.

            <details>
            <summary>Next steps</summary>

            \
            **If you still want to work on this:**
            - Submit a pull request showing your current state. You will be automatically assigned again.
            - Ask a maintainer to assign you again.
            </details>
      - name: Move issue corresponding column in "Candidates for University Projects"
        uses: m7kvqbe1/github-action-move-issues@main
        if: ${{ steps.assign.outputs.assigned == 'yes' || steps.assign.outputs.unassigned == 'yes' }}
        with:
          github-token: ${{ secrets.GH_TOKEN_ACTION_MOVE_ISSUE }}
          project-url: "https://github.com/orgs/JabRef/projects/3"
          target-labels: "ğŸ“ Assigned"
          target-column: "Assigned"
          ignored-columns: ""
          default-column: "Free to take"
          skip-if-not-in-project: true
      - name: Move issue corresponding column in "Good First Issues"
        uses: m7kvqbe1/github-action-move-issues@main
        if: ${{ steps.assign.outputs.assigned == 'yes' || steps.assign.outputs.unassigned == 'yes' }}
        with:
          github-token: ${{ secrets.GH_TOKEN_ACTION_MOVE_ISSUE }}
          project-url: "https://github.com/orgs/JabRef/projects/5"
          target-labels: "ğŸ“ Assigned"
          target-column: "Assigned"
          ignored-columns: ""
          default-column: "Free to take"
          skip-if-not-in-project: true
