name: On isuse comment

on:
  issue_comment:
    types: [created]

jobs:
  assign:
    if: github.repository_owner == 'JabRef'
    runs-on: ubuntu-latest
    permissions:
      contents: read
      issues: write
    steps:
      - name: Assign the user or unassign stale assignments
        id: assign
        uses: takanome-dev/assign-issue-action@edge
        with:
          github_token: '${{ secrets.GH_TOKEN_ASSIGN_ISSUE_ACTION  || github.token }}'
          # If this is updated, also update the number at unassign-issues.yml
          days_until_unassign: 14
          # 2: One person could have one PR opened and while waiting for feedback working on another one.
          max_assignments: 2
          max_overall_assignment_labels: "good first issue"
          max_overall_assignment_message: >
            ### âš ï¸ Assignment Limit Reached for Good First Issues


            Hi @{{ handle }}, you've already reached the limit of **{{ max_overall_assignment_count }}** active assignments for good first issues.
            Good first issues are a great way to get started with contributing to JabRef, and we want to ensure that all newcomers have the opportunity to work on them.


            While waiting for feedback on your current assignments, you are invited to move on to more advanced issues.
            Start at checking the [good second issues](https://github.com/JabRef/jabref/issues?q=sort%3Aupdated-desc%20is%3Aissue%20is%3Aopen%20label%3A%22good%20second%20issue%22%20no%3Aassignee).
          assigned_comment_newcomer: >
            ğŸ‘‹ Hey @{{ handle }}, thank you for your interest in this issue! ğŸ‰


            We're excited to have you on board.
            Start by exploring our [Contributing guidelines](https://github.com/JabRef/jabref/blob/main/CONTRIBUTING.md), and set up your local development workspace by following the steps in our [workspace setup guidelines](https://devdocs.jabref.org/getting-into-the-code/guidelines-for-setting-up-a-local-workspace) to get started smoothly.


            For questions on JabRef functionality, you can consult the [JabRef Guru](https://gurubase.io/g/jabref).
            For questions related to the codebase, please start using [DeepWiki](https://deepwiki.com/JabRef/jabref).


            In case you encounter failing tests during development, please check our [developer FAQs](https://devdocs.jabref.org/code-howtos/faq.html)!


            Still facing issues or having more questions?
            Feel free to ask here on GitHub or on [JabRef's Gitter chat](https://gitter.im/JabRef/jabref).
            Please don't hesitate to open a (draft) pull request early on to show the direction you are heading towards if unsure.


            Happy coding! ğŸš€
          assignment_suggestion_comment: >
            ğŸ‘‹ Hey @{{ handle }}, looks like youâ€™re eager to work on this issue â€” great! ğŸ‰
            It also looks like you don't know how to assign issues to yourself.
            Please read our [CONTRIBUTING.md](https://github.com/JabRef/jabref/blob/main/CONTRIBUTING.md) to find out how.
            It will also guide you in other aspects of contributing to JabRef.
          unassigned_comment: |
            ### ğŸ“‹ Assignment Update

            Hi @{{ handle }}, due to inactivity, you have been unassigned from this issue.

            <details>
            <summary>Next steps</summary>

            \
            **If you still want to work on this:**
            - Submit a pull request showing your current state. You will be automatically assigned again.
            - Ask a maintainer to assign you again.
            </details>
      - name: Move issue corresponding column in "Candidates for University Projects"
        uses: m7kvqbe1/github-action-move-issues@main
        if: ${{ steps.assign.outputs.assigned == 'yes' || steps.assign.outputs.unassigned == 'yes' }}
        with:
          github-token: ${{ secrets.GH_TOKEN_ACTION_MOVE_ISSUE }}
          project-url: "https://github.com/orgs/JabRef/projects/3"
          target-labels: "ğŸ“ Assigned"
          target-column: "Assigned"
          ignored-columns: ""
          default-column: "Free to take"
          skip-if-not-in-project: true
      - name: Move issue corresponding column in "Good First Issues"
        uses: m7kvqbe1/github-action-move-issues@main
        if: ${{ steps.assign.outputs.assigned == 'yes' || steps.assign.outputs.unassigned == 'yes' }}
        with:
          github-token: ${{ secrets.GH_TOKEN_ACTION_MOVE_ISSUE }}
          project-url: "https://github.com/orgs/JabRef/projects/5"
          target-labels: "ğŸ“ Assigned"
          target-column: "Assigned"
          ignored-columns: ""
          default-column: "Free to take"
          skip-if-not-in-project: true
