<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.scene.control.Button?>
<?import javafx.scene.control.CheckBox?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.control.RadioButton?>
<?import javafx.scene.control.TextField?>
<?import javafx.scene.control.ToggleGroup?>
<?import javafx.scene.layout.AnchorPane?>
<?import javafx.scene.layout.ColumnConstraints?>
<?import javafx.scene.layout.GridPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.VBox?>
<?import org.jabref.gui.commonfxcontrols.CitationKeyPatternsPanel?>
<?import org.jabref.gui.util.component.HelpButton?>
<fx:root spacing="10.0" type="VBox"
         xmlns="http://javafx.com/javafx" xmlns:fx="http://javafx.com/fxml"
         fx:controller="org.jabref.gui.preferences.citationkeypattern.CitationKeyPatternTab">
    <fx:define>
        <ToggleGroup fx:id="uniqueKeyLetters"/>
    </fx:define>
    <Label styleClass="titleHeader" text="%Citation key patterns"/>

    <GridPane styleClass="innerGridPane">
        <columnConstraints>
            <ColumnConstraints hgrow="SOMETIMES" percentWidth="30.0"/>
            <ColumnConstraints hgrow="SOMETIMES"/>
            <ColumnConstraints hgrow="NEVER"/>
        </columnConstraints>

        <Label styleClass="sectionHeader" text="%General"
               GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="0"/>

        <CheckBox fx:id="overwriteAllow" text="%Overwrite existing keys"
                GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="1"/>
        <HBox styleClass="prefIndent"
              GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="2">
            <CheckBox fx:id="overwriteWarning"
                      text="%Warn before overwriting existing keys"
                      disable="${!overwriteAllow.selected}"/>
        </HBox>
        <CheckBox fx:id="generateOnSave" text="%Generate keys before saving (only for entries without a key)"
                GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="3"/>
        <CheckBox fx:id="generateNewKeyOnImport" text="%Generate new keys for imported entries (overwriting their default)"
                GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="4"/>

        <Label text="%Letters after duplicate generated keys" GridPane.columnIndex="0"
               GridPane.columnSpan="3" GridPane.rowIndex="5"/>
        <VBox spacing="10.0" styleClass="prefIndent"
              GridPane.columnIndex="0" GridPane.columnSpan="3" GridPane.rowIndex="6">
            <RadioButton fx:id="letterStartA"
                         text="%Start on second duplicate key with letter A (a, b, ...)"
                         toggleGroup="$uniqueKeyLetters"/>
            <RadioButton fx:id="letterStartB"
                         text="%Start on second duplicate key with letter B (b, c, ...)"
                         toggleGroup="$uniqueKeyLetters"/>
            <RadioButton fx:id="letterAlwaysAdd"
                         text="%Always add letter (a, b, ...) to generated keys"
                         toggleGroup="$uniqueKeyLetters"/>
        </VBox>

        <Label text="%Replace (regular expression)"
               GridPane.columnIndex="0" GridPane.rowIndex="7"/>
        <HBox spacing="4.0" alignment="CENTER_LEFT"
              GridPane.columnIndex="1" GridPane.rowIndex="7">
            <TextField fx:id="keyPatternRegex" HBox.hgrow="ALWAYS"/>
            <Label text="%by"/>
            <TextField fx:id="keyPatternReplacement" HBox.hgrow="ALWAYS"/>
        </HBox>
        <HelpButton helpUrl="https://docs.jabref.org/setup/citationkeypatterns#replace-via-regular-expression"
                GridPane.columnIndex="2" GridPane.rowIndex="7"/>

        <Label text="%Remove the following characters:"
               GridPane.columnIndex="0" GridPane.rowIndex="8"/>
        <TextField fx:id="unwantedCharacters"
                GridPane.columnIndex="1" GridPane.rowIndex="8"/>

        <CheckBox fx:id="transliterateFieldsForCitationKey" text="%Transliterate fields for citation key"
                GridPane.columnIndex="0" GridPane.rowIndex="9"/>
    </GridPane>

    <HBox spacing="8.0">
        <Label styleClass="sectionHeader" text="%Key patterns"/>
        <VBox alignment="BOTTOM_CENTER">
            <HelpButton helpUrl="https://docs.jabref.org/setup/citationkeypatterns" styleClass="headerHelpButton"/>
        </VBox>
    </HBox>

    <Label text="%( Note: Press return to commit changes in the table! )"/>
    <AnchorPane>
        <CitationKeyPatternsPanel fx:id="bibtexKeyPatternTable"
                AnchorPane.leftAnchor="0.0" AnchorPane.rightAnchor="0.0" prefHeight="180.0"/>
        <Button text="%Reset All" onAction="#resetAllKeyPatterns"
                AnchorPane.rightAnchor="0.0" AnchorPane.topAnchor="0.0"/>
    </AnchorPane>
</fx:root>